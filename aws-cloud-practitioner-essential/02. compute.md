# compute in cloud

- EC2 - Elastic Compute Cloud
- EC2 instances are VMs running on a hypervisors
- Multi-tenancy - many VMs are running on one physical server with operating system and hypervisor
- CaaS - compute as service
- vertical scaling is allowed - you can start small
- you can choose what os is on the instances and which apps run on this instance. you also configure network (public/private visibility)
- you only pay for running instances. you dont pay for stopped instances - what?
- AMI - amazon machine image - defines os and additional software
- instance type - cpu, memory, network performance

## instance types
choose one of the following
- general purpose
- compute optimized
- memory optimized
- storage optimized
- accelerated computing

And then size

## how to provision
- management console
- CLI (cloudshell which has cli installed)
- SDK

they call call API hosted by aws to manage resources

EC2 instances - share responsibility model - almost everything needs to be done by the customer
- customer data
- client side data encryption
- server side encryption
- network traffic protection
- platform and application management
- os, firewall and network configuration

## payment options
- on demand
- savings plan - 72% discount compared to on demand
- reserved instances 
- spot instances - 90% discount - 2 minute warning - interruptable workload
- dedicated hosts - licensing, security, regulatory 
- dedicated instance

commit 1 or 3 year commitment

all upfront
partial upfront
no upfront

## scaling EC2
redundant EC2 instances across AZs is a good practise

key scaling metrics
amazon cloudwatch to collect data/metrics
EC2 scaling group
- minimum capacity
- desired 
- maximum 

## Elastic Load balancing (ELB)
- there are off the shelf load balancers that will work with aws but then you will have manage, patch, upgrade, handle failover, perform maintenance on it etc yourself
- takes requests and routes these to instances
- ELB between frontend and backend tiers. frontend doesnt know if and when a new instance spins up. newly spun backend only informs ELB that it is ready to work. frontend doesnt talk to backend, it talks to ELB.
- decouples architecture
- single point of contact for all incoming traffice to EC2 scaling group 

routing methods
- round robin
- least connections
- IP hash - all request from one client go to same server
- least response time

## messaging and queueing
- if two services talk to each directly, they are tightly coupled
- publish and subscribe model
- decoupled by adding a queue in between the two services, this is called loosely coupled

Amazon SQS (simple Queue Service)
data within a message is called payload
send, store and receive messages

Amazon Simple Notification Service (Amazon SNS)
notifications are not stored in any queue
channel for messages to be delivered
need a response right now

Amazon Event Bridge
- 




